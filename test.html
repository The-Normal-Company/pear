<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="equiv" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Scandit Simple Sample</title>
    <script src="https://cdn.jsdelivr.net/npm/scandit-sdk@5.x"></script>

    <link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet" />
    <style>
      body {
        background-color: white;
        color: black;
        text-align: center;
        font: 400 2.5vh "Open Sans", sans-serif;
      }
      /* the remaining CSS is omitted for brevity */
    </style>
  </head>
  <body onload="requestPermissions()">
    <!-- Your HTML content here -->

    <script>
      // Call this function when the page loads
      function requestPermissions() {
        // Request for Geolocation
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            function(position) {
              console.log("Geolocation permission granted.");
              console.log("Latitude: " + position.coords.latitude);
              console.log("Longitude: " + position.coords.longitude);
              // After the Geolocation permission has been granted, start the Scandit SDK
              startScanditSDK();
            },
            function() {
              console.log("Geolocation permission denied.");
            }
          );
        } else {
          console.log("Geolocation is not supported by this browser.");
        }

        // Request for Notifications
        if ("Notification" in window) {
          Notification.requestPermission()
            .then(function(result) {
              if (result === "granted") {
                console.log("Notification permission granted.");
              } else {
                console.log("Notification permission denied.");
              }
            });
        } else {
          console.log("This browser does not support desktop notification.");
        }
      }

      async function startScanditSDK() {
    try {
        let hasPermission = false;

        if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
            try {
                await navigator.mediaDevices.getUserMedia({ video: true });
                hasPermission = true;
            } catch (err) {
                alert("Unable to access the camera. Please grant the permission.");
            }
        }

        if (!hasPermission) {
            return;
        }

        const engine = await ScanditSDK.loadEngineLibrary(licenseKey);
        const scanner = await ScanditSDK.createBarcodeScanner(engine, {
            targetScanningFPS: 30,
            codeDuplicateFilter: 1000,
            enabledSymbologies: ["ean13", "upca", "qr", "data-matrix", "code-39", "code-128", "interleaved-2-of-5", "ean8"],
            recognitionMode: ScanditSDK.BarcodeScanner.RecognitionMode.LOCALIZED,
            guiStyle: ScanditSDK.BarcodeScanner.GuiStyle.NONE,
            viewport: {
                landscape: {
                    width: 100,
                    height: 100,
                    top: 0,
                    right: 0
                },
                portrait: {
                    width: 100,
                    height: 100,
                    top: 0,
                    right: 0
                },
            },
        });

        scanner.onReady(() => {
            scanner.start();
        });

    } catch (err) {
        console.error(err);
        alert('An error occurred when initializing the barcode scanner.');
    }
}
    </script>
  </body>
</html>
